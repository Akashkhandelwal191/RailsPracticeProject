<!-- Start Section For Navbar -->
<%= render 'layouts/navbar' %>
 <!-- End Section For Navbar -->

<section style="background-color: #eee;">
  <div class="container py-5">
    <div class="row">
      <div class="col-lg-4">
        <div class="card mb-4">
          <div class="card-body text-center">
          	<% if current_user.user_avatar.present? %>
                <%= image_tag current_user.user_avatar,class:"rounded-circle img-fluid img-size"%>
            <%else%>
              <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
              class="rounded-circle img-fluid" style="width: 150px;">
            <%end%>
            <h5 class="my-3"><%= current_user.first_name %> <%= current_user.last_name %></h5>
            <p class="text-muted mb-1">Normal User</p>
            <p class="text-muted mb-4">Not Specified</p>
            <div class="d-flex justify-content-center mb-2">
              <%= button_to "Deactivate Your Account",user_registration_path, data: { confirm: "Are you sure?", turbo_confirm: "Are you sure?" }, method: :delete,class:"btn btn-danger" %>
            </div>
          </div>
        </div>
        <div class="card mb-4 mb-lg-0">
          <div class="card-body p-0">
            <ul class="list-group list-group-flush rounded-3">
              <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                <i class="fas fa-globe fa-lg text-warning"></i>
                <p class="mb-0">https://mdbootstrap.com</p>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                <i class="fab fa-github fa-lg" style="color: #333333;"></i>
                <p class="mb-0">mdbootstrap</p>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                <i class="fab fa-twitter fa-lg" style="color: #55acee;"></i>
                <p class="mb-0">@mdbootstrap</p>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                <i class="fab fa-instagram fa-lg" style="color: #ac2bac;"></i>
                <p class="mb-0">mdbootstrap</p>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                <i class="fab fa-facebook-f fa-lg" style="color: #3b5998;"></i>
                <p class="mb-0">mdbootstrap</p>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-lg-8">
        <div class="card mb-4">
          <div class="card-body">
            <div class="border border-2 p-2">
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Full Name</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0"><%= current_user.first_name %> <%= current_user.last_name %></p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Username</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0"><%= current_user.username %></p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Email</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0"><%= current_user.email %></p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Mobile Number</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0"><%= current_user.mobile_number %></p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Gender</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0"><%= current_user.gender %></p>
              </div>
            </div>
             <div class="d-flex justify-content-end">
                <%= link_to 'Edit Details',edit_user_registration_path,class:"btn btn-warning" %>
              </div>
           </div>
            <hr>
             <div class="container border border-2 p-2">
              <h3>Managed Addresses</h3>
              <div class="mb-2">
                
                <button id="open-address-form" class="btn btn-outline-dark w-100">ADD A NEW ADDRESS</button>
              </div>

              <div id="address-form-container"></div>

              

              <div class="">
                <% if current_user.addresses.present? %>
                     <% current_user.addresses.each do |address| %>
                        <div class="border border-2 m-2 p-2" style="position: relative;">
                            <div class="">
                            <h3><%= address.address_type %></h3>
                            <p><%= address.area %>,<%= address.city %>,<%= address.state %>,<%= address.country%>,<%= address.postal_code%> </p>
                            </div>

                            <div style="position: absolute; top:2px;right:2px">
                              <%= button_to "Delete",address_path(address.id), data: { confirm: "Are you sure?", turbo_confirm: "Are you sure?" }, method: :delete,class:"btn btn-danger" %>
                            </div>                 
                        </div>
                     <%end%>
                <%else%>
                     <p class="text-muted mb-0">Not Specified </p>
                <%end%>
              </div>
            </div> 
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">
            <div class="card mb-4 mb-md-0">
              <div class="card-body">
                <p class="mb-4"> FAQs
                </p>
                <div class="" style="">
                <p class="mb-1" style="font-size: .77rem;">What happens when I update my email address (or mobile number)?</p>
                 
                <p class="mb-2">Your login email id (or mobile number) changes, likewise. You'll receive all your account related communication on your updated email address (or mobile number). </p>  
                  
                </div>

                <div class="mt-3" style="">
                <p class="mb-1" style="font-size: .77rem;">When will my Flipkart account be updated with the new email address (or mobile number)?</p>
                 
                <p class="mb-2">It happens as soon as you confirm the verification code sent to your email (or mobile) and save the changes.</p>  
                  
                </div>
                
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Start Section For Footer -->
<%= render 'layouts/footer' %>
<!-- End Section For Footer -->



<script>

  $(document).on('click', '#open-address-form', function () {
    $.ajax({
      url: '<%= new_address_path %>',
      type: 'GET',
      dataType: 'html',
      success: function (data) {
        $('#address-form-container').html(data);
      },
      error: function () {
        alert('An error occurred while loading the review form.');
      }
    });
  });
  

  $(document).on('click', '#cancel', function () {

       $('#address-form-container').html("");
  });




</script>



